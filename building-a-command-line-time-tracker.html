<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Building a command-line time tracker</title><meta name="description" content="This is my attempt to create a simple time tracker from the command line"/><meta property="og:title" content="Building a command-line time tracker"/><meta property="og:description" content="This is my attempt to create a simple time tracker from the command line"/><meta property="og:image" content="https://strdr4605.com/building-a-command-line-time-tracker.jpg"/><meta property="og:type" content="article"/><link rel="canonical" href="https://strdr4605.com/building-a-command-line-time-tracker"/><meta name="next-head-count" content="9"/><meta charSet="UTF-8"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><meta property="og:locale" content="en_GB"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="@strdr4605"/><meta name="theme-color" content="#FAF181"/><link rel="preload" href="/_next/static/css/83a77daccbc30077.css" as="style"/><link rel="stylesheet" href="/_next/static/css/83a77daccbc30077.css" data-n-g=""/><link rel="preload" href="/_next/static/css/bc274fc7c99985a3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/bc274fc7c99985a3.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9e60bad828f3ecaa.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-e267bb9839e5051c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0c351108ffe6ee8e.js" defer=""></script><script src="/_next/static/chunks/453-0a4b1ae71b489eee.js" defer=""></script><script src="/_next/static/chunks/pages/%5BpostSlug%5D-33ac54be726b76e3.js" defer=""></script><script src="/_next/static/qzu29rgk5LtoaMzSYlNe4/_buildManifest.js" defer=""></script><script src="/_next/static/qzu29rgk5LtoaMzSYlNe4/_ssgManifest.js" defer=""></script><script src="/_next/static/qzu29rgk5LtoaMzSYlNe4/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="Layout_container__n__U4"><article><h1>Building a command-line time tracker</h1><i><time dateTime="2021-03-21">21 Mar 2021</time></i> on <a href="/"><span>DragoÈ™ StrÄƒinu</span>&#x27;s blog</a><br/><div><p>I started working on a project and I wanted to track the time that I spend.
I searched and found desktop apps, websites, browser extensions, for time tracking.
But some of them were part of a big product with dashboards.
I even downloaded and tested tracking extensions for VSCode but some of them also required accounts on some platform for reporting.</p>
<p>I wanted something simple, start a task, stop a task, display the time.
Something that I can use for any project, task, activity, personal or work.
Knowing that most of the time I have my terminal open, I thought that it's the best place for me to use a tracker.
For example, before creating a new branch for the task,
I could start the timer, and when I need a pause, stop it.
All this in one terminal tab.</p>
<p>I started looking for command-line time tracker solutions.
I didn't find a lot. Most of them were written in Python, but for me, the features were too much.
I also found NodeJS packages, and one written in C that was way too simple as I need time in hours and minutes (not only seconds).</p>
<p>Don't know why but my initial thought was that a command-line time tracker should be implemented in shell script.
I found <a href="https://labs.tomasino.org/time-tracker-in-bash/">Time tracker in Bash</a> and I liked the features but there was no instruction on how to install,
and while trying the script was throwing some error (maybe was not compatible with macOS).</p>
<p>I decided to write one myself in shell script, as an idea that it can be used on any unix system, without the need to have Python, C or NodeJS installed.
I thought that it may take 4-5 hours to finish the first version.
I decided to call the command <code>tt</code> (from time tracker), as it's short to type and start working.</p>
<h2>Implementation</h2>
<p>First I started with a hello world script, and then I noticed something I use but I am not 100% sure why.
I am talking about the first line of most command-line scripts <code>#!/usr/bin/env bash</code>. Why it's needed?
After a search, I found that it's called <a href="https://en.wikipedia.org/wiki/Shebang_%28Unix%29">Shebang</a>.
I decided that I will put the link and explanation at the beginning of the file,
so people who may want to contribute or just see the implementation, will also know why this line is really needed.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/usr/bin/env sh</span>
<span class="token comment"># First 2 chars in the file are called Shebang https://en.wikipedia.org/wiki/Shebang_%28Unix%29</span>
<span class="token comment"># In this case:</span>
<span class="token comment">#   Execute this file with a "sh" interpreter, using the "env" program search path to find it.</span>
<span class="token comment"># Now you know!</span>

<span class="token function-name function">tt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre></div>
<p>Requirements are simple:</p>
<ol>
<li>Start an activity</li>
<li>Stop an activity</li>
<li>Log an activity and time spent (in hours and minutes)</li>
<li>Clean history</li>
</ol>
<p>As a first idea, we need two files:</p>
<ol>
<li><code>~/.tt_logs</code> - will store all the logs.</li>
<li><code>~/.tt_session</code> - will instore info about current activity started time.</li>
</ol>
<p>The session file will have <code>start_time</code> and <code>activity_name</code>. <br/>
Time will be stored in sec using <code>date +%s</code> which will return <a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a>.</p>
<p>Basic writing to a file with shell script is simple.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"start_time="</span> <span class="token operator">></span> ~/.tt_session
<span class="token builtin class-name">echo</span> <span class="token string">"activity_name="</span> <span class="token operator">>></span> ~/.tt_session
</code></pre></div>
<ul>
<li>The <code>></code> redirection operator writes <code>"start_time="</code> to a given file. If the file exists, it is truncated to zero length. Otherwise, the file is created. Be extra careful when using this operator as you may overwrite an important file.</li>
<li>The <code>>></code> redirection operator appends the output to a given file. The file is created if it does not exist.</li>
</ul>
<p>When finishing an activity the script should read the data from the session file and write it into the logs file.
There are multiple options to read from a file. After a lot of testing, I found a way that works for my case.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">start_time</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">'start_time='</span> <span class="token string">"<span class="token variable">$TT_SESSION</span>"</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-E</span> <span class="token string">"s/.*start_time=([0-9]+).*/<span title="\\" class="token entity">\\</span>1/"</span><span class="token variable">)</span></span>
</code></pre></div>
<p>To be honest, I don't like the solution, and I am sure you too, but I didn't want to spend more time on this.
You are welcome to contribute with a better one.</p>
<p>After 3 or 4 hours I understood that it will take more time to create this script as new use cases appeared.
What if I want to pause the activity, or maybe abort without logs?</p>
<p>While thinking about how to solve new use cases I also asked myself: Isn't it too much time spent on this script?
Why just don't use Python solutions with richer features (like starting an activity in past).
But I decided to push it to the end as while spending time on this I learned something new, and also if I will need more features I will just add them later.</p>
<p>Current functionality</p>
<div class="remark-highlight"><pre class="language-text"><code class="language-text">tt - time tracker

Tracks activity time with a simple start/stop syntax. Logs to CSV.
Allows one activity active at a time, per session.

usage: tt                                       # show this help
usage: tt (--help or -h)                        # show this help
usage: tt (--start or -s) [activity name]       # start a new activity
usage: tt (--pause or -p)                       # pauses current activity
usage: tt (--done or -d or --finish or -f)      # stop and log activity
usage: tt (--abort or -a)                       # stop activity, no log
usage: tt --clear-logs                          # delete log of previous activities
usage: tt --activity-name                       # show activity for current session
usage: tt (--logs or -l)                        # show logs of previous activities</code></pre></div>
<h2>Installation</h2>
<p>When searching on how to make my script function <code>tt</code> available globally on the system I hadn't found a 100% right solution, so I decided to go with <code>source</code>.</p>
<blockquote>
<p>The <code>source</code> command reads and executes commands from the file specified as its argument in the current shell environment. It is useful to load functions, variables, and configuration files into shell scripts.</p>
<blockquote>
<p><a href="https://linuxize.com/post/bash-source-command/">https://linuxize.com/post/bash-source-command/</a></p>
</blockquote>
</blockquote>
<p>This means that to use this time tracker you need to download the source and put it wherever you want.</p>
<p>For example, using <code>curl</code> to download and write in the file located in the home directory:</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> https://raw.githubusercontent.com/strdr4605/tt/master/tt.sh <span class="token operator">></span> <span class="token environment constant">$HOME</span>/tt.sh
</code></pre></div>
<p>Now you just need to add <code>source $HOME/tt.sh</code> into your shell config file.</p>
<p>Besides that, as a person that cares about code quality
I made sure to have a good code structure with separate functions for each use case and not a big <code>if else switch case</code> as some other shell scripts are.</p>
<p>In the end, I spent a day working on it (with some breaks and other tasks).
I would say it took 10-12 hours (with README, formating, and linting).
I don't know the exact time as I I haven't used a time tracker for this project ðŸ˜….</p>
<p>If want to contribute or just see the implementation, the project is on <a href="https://github.com/strdr4605/tt">https://github.com/strdr4605/tt</a>.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">tt <span class="token parameter variable">-f</span>

Sun Mar <span class="token number">21</span> <span class="token number">20</span>:39:04 UTC <span class="token number">2021</span> <span class="token operator">|</span> Writing this post <span class="token operator">|</span> 1h 43m
</code></pre></div>
</div><footer class="PostFooter_footer__nLJ4b">Liked this post? Follow me<!-- --> <a target="_blank" href="http://twitter.com/strdr4605" rel="noreferrer">@strdr4605</a> <!-- -->to get more updates.</footer></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"title":"Building a command-line time tracker","date":"2021-03-21T00:00:00.000Z","description":"This is my attempt to create a simple time tracker from the command line","tags":["tools","learning"],"slug":"building-a-command-line-time-tracker","contentHtml":"\u003cp\u003eI started working on a project and I wanted to track the time that I spend.\nI searched and found desktop apps, websites, browser extensions, for time tracking.\nBut some of them were part of a big product with dashboards.\nI even downloaded and tested tracking extensions for VSCode but some of them also required accounts on some platform for reporting.\u003c/p\u003e\n\u003cp\u003eI wanted something simple, start a task, stop a task, display the time.\nSomething that I can use for any project, task, activity, personal or work.\nKnowing that most of the time I have my terminal open, I thought that it's the best place for me to use a tracker.\nFor example, before creating a new branch for the task,\nI could start the timer, and when I need a pause, stop it.\nAll this in one terminal tab.\u003c/p\u003e\n\u003cp\u003eI started looking for command-line time tracker solutions.\nI didn't find a lot. Most of them were written in Python, but for me, the features were too much.\nI also found NodeJS packages, and one written in C that was way too simple as I need time in hours and minutes (not only seconds).\u003c/p\u003e\n\u003cp\u003eDon't know why but my initial thought was that a command-line time tracker should be implemented in shell script.\nI found \u003ca href=\"https://labs.tomasino.org/time-tracker-in-bash/\"\u003eTime tracker in Bash\u003c/a\u003e and I liked the features but there was no instruction on how to install,\nand while trying the script was throwing some error (maybe was not compatible with macOS).\u003c/p\u003e\n\u003cp\u003eI decided to write one myself in shell script, as an idea that it can be used on any unix system, without the need to have Python, C or NodeJS installed.\nI thought that it may take 4-5 hours to finish the first version.\nI decided to call the command \u003ccode\u003ett\u003c/code\u003e (from time tracker), as it's short to type and start working.\u003c/p\u003e\n\u003ch2\u003eImplementation\u003c/h2\u003e\n\u003cp\u003eFirst I started with a hello world script, and then I noticed something I use but I am not 100% sure why.\nI am talking about the first line of most command-line scripts \u003ccode\u003e#!/usr/bin/env bash\u003c/code\u003e. Why it's needed?\nAfter a search, I found that it's called \u003ca href=\"https://en.wikipedia.org/wiki/Shebang_%28Unix%29\"\u003eShebang\u003c/a\u003e.\nI decided that I will put the link and explanation at the beginning of the file,\nso people who may want to contribute or just see the implementation, will also know why this line is really needed.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token shebang important\"\u003e#!/usr/bin/env sh\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# First 2 chars in the file are called Shebang https://en.wikipedia.org/wiki/Shebang_%28Unix%29\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# In this case:\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e#   Execute this file with a \"sh\" interpreter, using the \"env\" program search path to find it.\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# Now you know!\u003c/span\u003e\n\n\u003cspan class=\"token function-name function\"\u003ett\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRequirements are simple:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eStart an activity\u003c/li\u003e\n\u003cli\u003eStop an activity\u003c/li\u003e\n\u003cli\u003eLog an activity and time spent (in hours and minutes)\u003c/li\u003e\n\u003cli\u003eClean history\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAs a first idea, we need two files:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e~/.tt_logs\u003c/code\u003e - will store all the logs.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e~/.tt_session\u003c/code\u003e - will instore info about current activity started time.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThe session file will have \u003ccode\u003estart_time\u003c/code\u003e and \u003ccode\u003eactivity_name\u003c/code\u003e. \u003cbr/\u003e\nTime will be stored in sec using \u003ccode\u003edate +%s\u003c/code\u003e which will return \u003ca href=\"https://en.wikipedia.org/wiki/Unix_time\"\u003eUnix time\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eBasic writing to a file with shell script is simple.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token builtin class-name\"\u003eecho\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"start_time=\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e ~/.tt_session\n\u003cspan class=\"token builtin class-name\"\u003eecho\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"activity_name=\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003e\u003c/span\u003e ~/.tt_session\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eThe \u003ccode\u003e\u003e\u003c/code\u003e redirection operator writes \u003ccode\u003e\"start_time=\"\u003c/code\u003e to a given file. If the file exists, it is truncated to zero length. Otherwise, the file is created. Be extra careful when using this operator as you may overwrite an important file.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003e\u003e\u003e\u003c/code\u003e redirection operator appends the output to a given file. The file is created if it does not exist.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhen finishing an activity the script should read the data from the session file and write it into the logs file.\nThere are multiple options to read from a file. After a lot of testing, I found a way that works for my case.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token assign-left variable\"\u003estart_time\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token variable\"\u003e\u003cspan class=\"token variable\"\u003e$(\u003c/span\u003e\u003cspan class=\"token function\"\u003egrep\u003c/span\u003e \u003cspan class=\"token string\"\u003e'start_time='\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\u003cspan class=\"token variable\"\u003e$TT_SESSION\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003esed\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e-E\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"s/.*start_time=([0-9]+).*/\u003cspan title=\"\\\\\" class=\"token entity\"\u003e\\\\\u003c/span\u003e1/\"\u003c/span\u003e\u003cspan class=\"token variable\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTo be honest, I don't like the solution, and I am sure you too, but I didn't want to spend more time on this.\nYou are welcome to contribute with a better one.\u003c/p\u003e\n\u003cp\u003eAfter 3 or 4 hours I understood that it will take more time to create this script as new use cases appeared.\nWhat if I want to pause the activity, or maybe abort without logs?\u003c/p\u003e\n\u003cp\u003eWhile thinking about how to solve new use cases I also asked myself: Isn't it too much time spent on this script?\nWhy just don't use Python solutions with richer features (like starting an activity in past).\nBut I decided to push it to the end as while spending time on this I learned something new, and also if I will need more features I will just add them later.\u003c/p\u003e\n\u003cp\u003eCurrent functionality\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-text\"\u003e\u003ccode class=\"language-text\"\u003ett - time tracker\n\nTracks activity time with a simple start/stop syntax. Logs to CSV.\nAllows one activity active at a time, per session.\n\nusage: tt                                       # show this help\nusage: tt (--help or -h)                        # show this help\nusage: tt (--start or -s) [activity name]       # start a new activity\nusage: tt (--pause or -p)                       # pauses current activity\nusage: tt (--done or -d or --finish or -f)      # stop and log activity\nusage: tt (--abort or -a)                       # stop activity, no log\nusage: tt --clear-logs                          # delete log of previous activities\nusage: tt --activity-name                       # show activity for current session\nusage: tt (--logs or -l)                        # show logs of previous activities\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eInstallation\u003c/h2\u003e\n\u003cp\u003eWhen searching on how to make my script function \u003ccode\u003ett\u003c/code\u003e available globally on the system I hadn't found a 100% right solution, so I decided to go with \u003ccode\u003esource\u003c/code\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe \u003ccode\u003esource\u003c/code\u003e command reads and executes commands from the file specified as its argument in the current shell environment. It is useful to load functions, variables, and configuration files into shell scripts.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://linuxize.com/post/bash-source-command/\"\u003ehttps://linuxize.com/post/bash-source-command/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThis means that to use this time tracker you need to download the source and put it wherever you want.\u003c/p\u003e\n\u003cp\u003eFor example, using \u003ccode\u003ecurl\u003c/code\u003e to download and write in the file located in the home directory:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003ecurl\u003c/span\u003e https://raw.githubusercontent.com/strdr4605/tt/master/tt.sh \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token environment constant\"\u003e$HOME\u003c/span\u003e/tt.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow you just need to add \u003ccode\u003esource $HOME/tt.sh\u003c/code\u003e into your shell config file.\u003c/p\u003e\n\u003cp\u003eBesides that, as a person that cares about code quality\nI made sure to have a good code structure with separate functions for each use case and not a big \u003ccode\u003eif else switch case\u003c/code\u003e as some other shell scripts are.\u003c/p\u003e\n\u003cp\u003eIn the end, I spent a day working on it (with some breaks and other tasks).\nI would say it took 10-12 hours (with README, formating, and linting).\nI don't know the exact time as I I haven't used a time tracker for this project ðŸ˜….\u003c/p\u003e\n\u003cp\u003eIf want to contribute or just see the implementation, the project is on \u003ca href=\"https://github.com/strdr4605/tt\"\u003ehttps://github.com/strdr4605/tt\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003ett \u003cspan class=\"token parameter variable\"\u003e-f\u003c/span\u003e\n\nSun Mar \u003cspan class=\"token number\"\u003e21\u003c/span\u003e \u003cspan class=\"token number\"\u003e20\u003c/span\u003e:39:04 UTC \u003cspan class=\"token number\"\u003e2021\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e Writing this post \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e 1h 43m\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n"},"_superjson":{"values":{"postData.date":["Date"]}}},"__N_SSG":true},"page":"/[postSlug]","query":{"postSlug":"building-a-command-line-time-tracker"},"buildId":"qzu29rgk5LtoaMzSYlNe4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>