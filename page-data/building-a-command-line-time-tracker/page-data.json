{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/building-a-command-line-time-tracker","result":{"data":{"post":{"__typename":"MdxPost","slug":"/building-a-command-line-time-tracker","title":"Building a command-line time tracker","date":"21.03.2021","tags":[{"name":"tools","slug":"tools"},{"name":"learning","slug":"learning"}],"description":"This is my attempt to create a simple time tracker from the command line","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Building a command-line time tracker\",\n  \"date\": \"2021-03-21T00:00:00.000Z\",\n  \"description\": \"This is my attempt to create a simple time tracker from the command line\",\n  \"tags\": [\"tools\", \"learning\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I started working on a project and I wanted to track the time that I spend.\\nI searched and found desktop apps, websites, browser extensions, for time tracking.\\nBut some of them were part of a big product with dashboards.\\nI even downloaded and tested tracking extensions for VSCode but some of them also required accounts on some platform for reporting.\"), mdx(\"p\", null, \"I wanted something simple, start a task, stop a task, display the time.\\nSomething that I can use for any project, task, activity, personal or work.\\nKnowing that most of the time I have my terminal open, I thought that it's the best place for me to use a tracker.\\nFor example, before creating a new branch for the task,\\nI could start the timer, and when I need a pause, stop it.\\nAll this in one terminal tab.\"), mdx(\"p\", null, \"I started looking for command-line time tracker solutions.\\nI didn't find a lot. Most of them were written in Python, but for me, the features were too much.\\nI also found NodeJS packages, and one written in C that was way too simple as I need time in hours and minutes (not only seconds).\"), mdx(\"p\", null, \"Don't know why but my initial thought was that a command-line time tracker should be implemented in shell script.\\nI found \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://labs.tomasino.org/time-tracker-in-bash/\"\n  }), \"Time tracker in Bash\"), \" and I liked the features but there was no instruction on how to install,\\nand while trying the script was throwing some error (maybe was not compatible with macOS).\"), mdx(\"p\", null, \"I decided to write one myself in shell script, as an idea that it can be used on any unix system, without the need to have Python, C or NodeJS installed.\\nI thought that it may take 4-5 hours to finish the first version.\\nI decided to call the command \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tt\"), \" (from time tracker), as it's short to type and start working.\"), mdx(\"h2\", {\n    \"id\": \"implementation\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#implementation\",\n    \"aria-label\": \"implementation permalink\",\n    \"className\": \"remark-autolink-headers before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"height\": \"20\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"20\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Implementation\"), mdx(\"p\", null, \"First I started with a hello world script, and then I noticed something I use but I am not 100% sure why.\\nI am talking about the first line of most command-line scripts \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"#!/usr/bin/env bash\"), \". Why it's needed?\\nAfter a search, I found that it's called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://en.wikipedia.org/wiki/Shebang_%28Unix%29\"\n  }), \"Shebang\"), \".\\nI decided that I will put the link and explanation at the beginning of the file,\\nso people who may want to contribute or just see the implementation, will also know why this line is really needed.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"#!/usr/bin/env sh\\n# First 2 chars in the file are called Shebang https://en.wikipedia.org/wiki/Shebang_%28Unix%29\\n# In this case:\\n#   Execute this file with a \\\"sh\\\" interpreter, using the \\\"env\\\" program search path to find it.\\n# Now you know!\\n\\ntt() {\\n\")), mdx(\"p\", null, \"Requirements are simple:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Start an activity\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Stop an activity\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Log an activity and time spent (in hours and minutes)\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Clean history\")), mdx(\"p\", null, \"As a first idea, we need to files:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"~/.tt_logs\"), \" - will store all the logs.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"~/.tt_session\"), \" - will instore info about current activity started time.\")), mdx(\"p\", null, \"The session file will have \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"start_time\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"activity_name\"), \". \", mdx(\"br\", null), \"\\nTime will be stored in sec using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"date +%s\"), \" which will return \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://en.wikipedia.org/wiki/Unix_time\"\n  }), \"Unix time\"), \".\"), mdx(\"p\", null, \"Basic writing to a file with shell script is simple.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"echo \\\"start_time=\\\" > ~/.tt_session\\necho \\\"activity_name=\\\" >> ~/.tt_session\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \">\"), \" redirection operator writes \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"\\\"start_time=\\\"\"), \" to a given file. If the file exists, it is truncated to zero length. Otherwise, the file is created. Be extra careful when using this operator as you may overwrite an important file.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \">>\"), \" redirection operator appends the output to a given file. The file is created if it does not exist.\")), mdx(\"p\", null, \"When finishing an activity the script should read the data from the session file and write it into the logs file.\\nThere are multiple options to read from a file. After a lot of testing, I found a way that works for my case.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"start_time=$(grep 'start_time=' \\\"$TT_SESSION\\\" | sed -E \\\"s/.*start_time=([0-9]+).*/\\\\\\\\1/\\\")\\n\")), mdx(\"p\", null, \"To be honest, I don't like the solution, and I am sure you too, but I didn't want to spend more time on this.\\nYou are welcome to contribute with a better one.\"), mdx(\"p\", null, \"After 3 or 4 hours I understood that it will take more time to create this script as new use cases appeared.\\nWhat if I want to pause the activity, or maybe abort without logs?\"), mdx(\"p\", null, \"While thinking about how to solve new use cases I also asked myself: Isn't it too much time spent on this script?\\nWhy just don't use Python solutions with richer features (like starting an activity in past).\\nBut I decided to push it to the end as while spending time on this I learned something new, and also if I will need more features I will just add them later.\"), mdx(\"p\", null, \"Current functionality\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-text\"\n  }), \"tt - time tracker\\n\\nTracks activity time with a simple start/stop syntax. Logs to CSV.\\nAllows one activity active at a time, per session.\\n\\nusage: tt                                       # show this help\\nusage: tt (--help or -h)                        # show this help\\nusage: tt (--start or -s) [activity name]       # start a new activity\\nusage: tt (--pause or -p)                       # pauses current activity\\nusage: tt (--done or -d or --finish or -f)      # stop and log activity\\nusage: tt (--abort or -a)                       # stop activity, no log\\nusage: tt --clear-logs                          # delete log of previous activities\\nusage: tt --activity-name                       # show activity for current session\\nusage: tt (--logs or -l)                        # show logs of previous activities\\n\")), mdx(\"h2\", {\n    \"id\": \"installation\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#installation\",\n    \"aria-label\": \"installation permalink\",\n    \"className\": \"remark-autolink-headers before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"height\": \"20\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"20\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Installation\"), mdx(\"p\", null, \"When searching on how to make my script function \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tt\"), \" available globally on the system I hadn't found a 100% right solution, so I decided to go with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"source\"), \".\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"source\"), \" command reads and executes commands from the file specified as its argument in the current shell environment. It is useful to load functions, variables, and configuration files into shell scripts.\"), mdx(\"blockquote\", {\n    parentName: \"blockquote\"\n  }, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://linuxize.com/post/bash-source-command/\"\n  }), \"https://linuxize.com/post/bash-source-command/\")))), mdx(\"p\", null, \"This means that to use this time tracker you need to download the source and put it wherever you want.\"), mdx(\"p\", null, \"For example, using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"curl\"), \" to download and write in the file located in the home directory:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"curl https://raw.githubusercontent.com/strdr4605/tt/master/tt.sh > $HOME/tt.sh\\n\")), mdx(\"p\", null, \"Now you just need to add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"source $HOME/tt.sh\"), \" into your shell config file.\"), mdx(\"p\", null, \"Besides that, as a person that cares about code quality\\nI made sure to have a good code structure with separate functions for each use case and not a big \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"if else switch case\"), \" as some other shell scripts are.\"), mdx(\"p\", null, \"In the end, I spent a day working on it (with some breaks and other tasks).\\nI would say it took 10-12 hours (with README, formating, and linting).\\nI don't know the exact time as I I haven't used a time tracker for this project \\uD83D\\uDE05.\"), mdx(\"p\", null, \"If want to contribute or just see the implementation, the project is on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/strdr4605/tt\"\n  }), \"https://github.com/strdr4605/tt\"), \".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"tt -f\\n\\nSun Mar 21 20:39:04 UTC 2021 | Writing this post | 1h 43m\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"I started working on a project and I wanted to track the time that I spend.\nI searched and found desktop apps, websites, browser extensions…","timeToRead":3,"banner":null}},"pageContext":{"slug":"/building-a-command-line-time-tracker","formatString":"DD.MM.YYYY"}},"staticQueryHashes":["3090400250","3090400250","318001574"]}