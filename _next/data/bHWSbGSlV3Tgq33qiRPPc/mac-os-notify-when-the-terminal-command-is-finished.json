{"pageProps":{"postData":{"title":"MacOS: notify when the terminal command is finished","date":"2023-04-20T00:00:00.000Z","description":"I created a small bash function to notify me when a long-running terminal command finishes","tags":["macos","bash","zsh"],"slug":"mac-os-notify-when-the-terminal-command-is-finished","contentHtml":"<p>After reading <a href=\"https://evanhahn.com/a-decade-of-dotfiles/\">A decade of dotfiles</a> I wanted to create a similar bash function to <code>boop</code>.</p>\n<p>And here it is:</p>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ~/.zshrc</span>\n\n<span class=\"token comment\"># ...rest of zshrc</span>\n\n,<span class=\"token function-name function\">notify</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin class-name\">local</span> <span class=\"token assign-left variable\">last_exit_status</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$?</span>\"</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$last_exit_status</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">'0'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    osascript <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"display notification <span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>Done<span title=\"\\&#x22;\" class=\"token entity\">\\\"</span> with title <span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>Good<span title=\"\\&#x22;\" class=\"token entity\">\\\"</span> sound name <span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>Fonk<span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>\"</span>\n  <span class=\"token keyword\">else</span>\n    osascript <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"display notification <span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>Exit code: <span class=\"token variable\">$last_exit_status</span><span title=\"\\&#x22;\" class=\"token entity\">\\\"</span> with title <span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>Bad<span title=\"\\&#x22;\" class=\"token entity\">\\\"</span> sound name <span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>Ping<span title=\"\\&#x22;\" class=\"token entity\">\\\"</span>\"</span>\n  <span class=\"token keyword\">fi</span>\n  <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">exit</span> <span class=\"token string\">\"<span class=\"token variable\">$last_exit_status</span>\"</span><span class=\"token variable\">)</span></span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>It uses <a href=\"https://ss64.com/osx/osascript.html\">osascript</a> to execute the AppleScripts that pushes the notification.<br>\nAccording to <a href=\"https://stackoverflow.com/questions/67406491/osascript-how-to-pass-in-a-variable/67413043#67413043\">stackoverflow</a>\nthis is not the best way to pass bash variable to osascript,\nbut I did not understand how to do it for my use case and as I use <code>last_exit_status</code> there should be no problem.</p>\n<p>usage:</p>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> run <span class=\"token builtin class-name\">test</span><span class=\"token punctuation\">;</span>,notify\n</code></pre></div>\n<p>I prefix the function name with a comma to faster search for it when doing <code>;,&#x3C;Tab></code>.</p>\n<p>You can test it with <code>(exit 0);,notify</code> and <code>(exit 1);,notify</code>.</p>\n<p><img src=\"/notify-good.png\" alt=\"notify good\">\n<img src=\"/notify-bad.png\" alt=\"notify bad\"></p>\n"},"_superjson":{"values":{"postData.date":["Date"]}}},"__N_SSG":true}